from pwn import *
from time import *

host = 'pwnable.kr'
port = 9007

if __name__ == '__main__':
        s = remote(host, port)
        print(s.recv())

        cnt = 0
        for i in range(100):
                s.recvuntil('N=')
                coin = int(s.recvuntil(' '))

                s.recvuntil('C=')
                c = int(s.recvuntil('\n')[:-1])

                start = 0
                end = coin

                while(1):
                        arg = ''
                        if start > end:
                                break
                        for i in range(start, ((start + end) / 2) + 1):
                                arg += '{} '.format(i)
                        s.sendline(arg)
                        print('[*] arg : {}'.format(arg))

                        result = s.recv()
                        print('[*] result : {}'.format(result))

                        if result.find('Correct') > -1:
                                break
                        elif int(result) % 10 != 0:
                                end = (start + end) / 2
                        else:
                                start = ((start + end) / 2) + 1
                cnt += 1
                print('[*] collect : {}'.format(cnt))

                sleep(0.2)

        print(s.recv())