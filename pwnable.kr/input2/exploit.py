from pwn import *

# stage 1
argvs = [str(i) for i in range(100)]
argvs[ord('A')] = '\x00'
argvs[ord('B')] = '\x20\x0a\x0d'

# stage 2
with open('stage2', 'a') as f:
        f.write('\x00\x0a\x02\xff')

# stage 3
setenv = {'\xde\xad\xbe\xef' : '\xca\xfe\xba\xbe'}

# stage 4
with open ('\x0a', 'a') as f:
        f.write('\x00\x00\x00\x00')

# stage 5
argvs[ord('C')] = '18888'

p = process(executable='/home/input2/input', argv=argvs, stderr=open('stage2'), env=setenv)

# stage 2
p.sendline('\x00\x0a\x00\xff')

# stage 5
s = remote('localhost', 18888)
s.send('\xde\xad\xbe\xef')

p.interactive()

